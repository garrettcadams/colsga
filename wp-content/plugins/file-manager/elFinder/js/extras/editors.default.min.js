!function(e){fm_menu_icon_base_url="../wp-content/plugins/file-manager/elFinder/",function(e,t){if("function"==typeof define&&define.amd)define(["elfinder"],e);else if(t){var i=t.prototype._options.commandsOptions.edit.editors;t.prototype._options.commandsOptions.edit.editors=i.concat(e(t))}}(function(t){"use strict";var i,n=window.location.search.match(/getfile=([a-z]+)/),o=t.prototype.hasRequire,a=function(){var e;try{e=!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(t){e=!!("undefined"==typeof window.orientation||navigator&&navigator.mimeTypes["application/x-shockwave-flash"])}return e}(),r={bmp:"image/x-ms-bmp",dng:"image/x-adobe-dng",gif:"image/gif",jpeg:"image/jpeg",jpg:"image/jpeg",pdf:"application/pdf",png:"image/png",ppm:"image/x-portable-pixmap",psd:"image/vnd.adobe.photoshop",pxd:"image/x-pixlr-data",svg:"image/svg+xml",tiff:"image/tiff",webp:"image/webp",xcf:"image/x-xcf",sketch:"application/x-sketch"},s=function(e,t){i||(i=t.arrayFlip(r));var n=i[e]||t.mimeTypes[e];return"jpeg"===n&&(n="jpg"),n},c=function(e,t){var i=jQuery.Deferred();try{var n=document.createElement("canvas"),o=n.getContext("2d"),a=new Image,r=function(){var e,o,a=n.toDataURL(t);e=(o=a.match(/^data:([a-z0-9]+\/[a-z0-9.+-]+)/i))?o[1]:"",e.toLowerCase()===t.toLowerCase()?i.resolve(n.toDataURL(t),n):i.reject()};return a.src=e,jQuery(a).on("load",function(){try{n.width=a.width,n.height=a.height,o.drawImage(a,0,0),r()}catch(e){i.reject()}}).on("error",function(){i.reject()}),i}catch(s){return i.reject()}},d=function(e,t,i,n){var o,a=jQuery(this).children("img:first").data("ext",s(t.mime,n)),r=jQuery('<div class="elfinder-edit-spinner elfinder-edit-image"/>').html('<span class="elfinder-spinner-text">'+n.i18n("ntfloadimg")+'</span><span class="elfinder-spinner"/>').hide().appendTo(this);i.match(/^data:/)||(o=n.openUrl(t.hash),a.attr("_src",i)),a.attr("id",e+"-img").attr("src",o||i).css({height:"","max-width":"100%","max-height":"100%",cursor:"pointer"}).data("loading",function(e){var t=a.closest(".elfinder-dialog").find("button,.elfinder-titlebar-button");return t.prop("disabled",!e)[e?"removeClass":"addClass"]("ui-state-disabled"),a.css("opacity",e?"":"0.3"),r[e?"hide":"show"](),a})},l=function(e,t){var i,n,o,a=e.attr("style");try{e.attr("style",""),i=e.get(0),n=document.createElement("canvas"),n.width=i.width,n.height=i.height,e.attr("style",a),n.getContext("2d").drawImage(i,0,0),o=n.toDataURL(t)}catch(r){o=e.attr("src")}return o},p=function(){if(a&&window.parent!==window){var e,t,i,n,o,s=window.location.search.match(/[?&]pixlr=([^&]+)/),c=window.location.search.match(/[?&]image=([^&]+)/);s&&(e=window.parent,t=e.jQuery("#"+s[1]+"iframe").hide(),n=e.jQuery("#"+s[1]).data("resizeoff")(),"http"===c[1].substr(0,4)?(i=c[1],o=i.replace(/.+\.([^.]+)$/,"$1"),n.data("ext")!==o&&n.closest(".ui-dialog").trigger("changeType",{extention:o,mime:r[o]}),"https:"===window.location.protocol&&(i=i.replace(/^http:/,"https:")),n.on("load error",function(){n.data("loading")(!0)}).attr("src",i).data("loading")()):n.data("loading")(!0),t.trigger("destroy").remove())}},m=function(e,t){a&&!t.UA.ltIE8||(this.disabled=!0)},u=function(t,i){var n,o=this,a=this.fm,r=a.res("class","preventback"),s=e(i).children("img:first").data("loading")().data("resizeoff",function(){return e(window).off("resize."+s.attr("id")),c.addClass(r),s}).on("click",function(){g()}),c=e(i).closest(".ui-dialog"),d=a.getUI(),l=a.getUI("toast"),p=e('<iframe class="ui-front" allowtransparency="true">'),m=this.file,u=15,f=function(e){e?(p.trigger("destroy").remove(),s.data("loading")(!0),a.error(e)):(l.appendTo(c.closest(".ui-dialog")),a.toast({mode:"info",msg:"Can not launch Pixlr yet. Waiting "+u+" seconds.",button:{text:"Abort",click:function(){p.trigger("destroy").remove(),s.data("loading")(!0)}},onHidden:function(){1===l.children().length&&l.appendTo(a.getUI())}}),n=setTimeout(e,1e3*u))},g=function(){var l="https://pixlr.com/"+t+"/?s=c",g=window.location.href.toString().replace(/#.*$/,""),h={};n=setTimeout(f,1e3*u),g+=(g.indexOf("?")===-1?"?":"&")+"pixlr="+s.attr("id"),l+="&referrer=elFinder&locktitle=true",l+="&exit="+encodeURIComponent(g+"&image=0"),l+="&target="+encodeURIComponent(g),l+="&title="+encodeURIComponent(m.name),l+="&image="+encodeURIComponent(s.attr("_src")),h.src=l,h.css={width:"100%",height:e(window).height()+"px",position:"fixed",display:"block",backgroundColor:"transparent",border:"none",top:0,right:0},o.trigger("Prepare",{node:i,editorObj:void 0,instance:p,opts:h}),p.attr("id",s.attr("id")+"iframe").attr("src",h.src).css(h.css).one("load",function(){n&&clearTimeout(n),setTimeout(function(){p.is(":hidden")&&f("Please disable your ad blocker.")},1e3),c.addClass(r),a.toggleMaximize(p,!0),a.toFront(p)}).on("destroy",function(){a.toggleMaximize(p,!1)}).on("error",f).appendTo(d.hasClass("elfinder-fullscreen")?d:"body")};e(i).on("saveAsFail",g),g()},f=function(t){var i,n=e(t),o=e.Deferred().always(function(){n.off("load",s)}),a="about:blank",r=function(){i=setTimeout(function(){var e;try{e=base.contentWindow.location.href}catch(t){e=null}e===a?o.resolve():--c>0?r():o.reject()},500)},s=function(){i&&clearTimeout(i),o.resolve()},c=20;return n.one("load",s),t.src=a,r(),o};return p(),n&&(n=n[1],"ckeditor"===n&&(t.prototype._options.getFileCallback=function(e,t){window.opener.CKEDITOR.tools.callFunction(function(){var e=new RegExp("(?:[?&]|&amp;)CKEditorFuncNum=([^&]+)","i"),t=window.location.search.match(e);return t&&t.length>1?t[1]:""}(),t.convAbsUrl(e.url)),t.destroy(),window.close()})),[{info:{id:"tuiimgedit",name:"TUI Image Editor",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -48",dataScheme:!0,schemeContent:!0,openMaximized:!0,canMakeEmpty:!1,integrate:{title:"TOAST UI Image Editor",link:"http://ui.toast.com/tui-image-editor/"}},mimes:["image/jpeg","image/png","image/gif","image/svg+xml","image/x-ms-bmp"],html:'<div class="elfinder-edit-imageeditor"><canvas></canvas></div>',setup:function(e,t){t.UA.ltIE8||t.UA.Mobile?this.disabled=!0:(this.opts=Object.assign({version:"v3.7.0"},e.extraOptions.tuiImgEditOpts||{},{iconsPath:t.baseUrl+"img/tui-",theme:{}}),t.isSameOrigin(this.opts.iconsPath)||(this.disabled=!0,t.debug("warning","Setting `commandOptions.edit.extraOptions.tuiImgEditOpts.iconsPath` MUST follow the same origin policy.")))},init:function(e,t,i,n){this.data("url",i)},load:function(t){var i,n=this,o=this.fm,a=e.Deferred(),r=o.options.cdns,s=n.confObj.opts.version,c=function(i){var r,s,c,d,l=e(t),p=l.parent(),m=n.confObj.opts,u=m.iconsPath,f=e('<div class="tui-image-editor-container">').appendTo(p),g=[e('<div class="tui-image-editor-submenu"/>').appendTo(f),e('<div class="tui-image-editor-controls"/>').appendTo(f)],h=new i(t,{includeUI:{loadImage:{path:l.data("url"),name:n.file.name},theme:Object.assign(m.theme,{"menu.normalIcon.path":u+"icon-d.svg","menu.normalIcon.name":"icon-d","menu.activeIcon.path":u+"icon-b.svg","menu.activeIcon.name":"icon-b","menu.disabledIcon.path":u+"icon-a.svg","menu.disabledIcon.name":"icon-a","menu.hoverIcon.path":u+"icon-c.svg","menu.hoverIcon.name":"icon-c","submenu.normalIcon.path":u+"icon-d.svg","submenu.normalIcon.name":"icon-d","submenu.activeIcon.path":u+"icon-c.svg","submenu.activeIcon.name":"icon-c"}),initMenu:"filter",menuBarPosition:"bottom"},cssMaxWidth:Math.max(300,p.width()),cssMaxHeight:Math.max(200,p.height()-(g[0].height()+g[1].height()+3)),usageStatistics:!1}),v=l.find("canvas:first").get(0),b=function(t){if("undefined"!=typeof t){var i,n,o=e(v),a=parseInt(o.attr("width")),r=parseInt(o.attr("height")),s=a/r;0===t?(i=a,n=r):(i=parseInt(o.css("max-width"))+Number(t),n=i/s,i>a&&n>r&&(i=a,n=r)),w.text(Math.round(i/a*100)+"%"),h.resizeCanvasDimension({width:i,height:n}),d&&setTimeout(function(){d&&b(t)},50)}},x=e('<span class="ui-icon ui-icon-plusthick"/>').data("val",10),y=e('<span class="ui-icon ui-icon-minusthick"/>').data("val",-10),w=e("<button/>").css("width","4em").text("%").attr("title","100%").data("val",0);f.remove(),l.removeData("url").data("mime",n.file.mime),"image/jpeg"===n.file.mime?(l.data("quality",o.storage("jpgQuality")||o.option("jpgQuality")),r=e('<input type="number" class="ui-corner-all elfinder-resize-quality elfinder-tabstop"/>').attr("min","1").attr("max","100").attr("title","1 - 100").on("change",function(){var e=r.val();l.data("quality",e),s&&cancelAnimationFrame(s),s=requestAnimationFrame(function(){v.toBlob(function(e){e&&r.next("span").text(" ("+o.formatSize(e.size)+")")},"image/jpeg",Math.max(Math.min(e,100),1)/100)})}).val(l.data("quality")),e('<div class="ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality"/>').append(e("<span>").html(o.i18n("quality")+" : "),r,e("<span/>")).prependTo(l.parent().next())):"image/svg+xml"===n.file.mime&&l.closest(".ui-dialog").trigger("changeType",{extention:"png",mime:"image/png",keepEditor:!0}),e('<div class="ui-dialog-buttonset elfinder-edit-extras"/>').append(y,w,x).attr("title",o.i18n("scale")).on("click","span,button",function(){b(e(this).data("val"))}).on("mousedown mouseup mouseleave","span",function(t){d=!1,c&&clearTimeout(c),"mousedown"===t.type&&(c=setTimeout(function(){d=!0,b(e(t.target).data("val"))},500))}).prependTo(l.parent().next()),setTimeout(function(){a.resolve(h),r&&(r.trigger("change"),h.on("redoStackChanged undoStackChanged",function(){r.trigger("change")})),b(null)},100)};return n.confObj.editor?c(n.confObj.editor):(i=e.Deferred(),o.loadCss([r.tui+"/tui-color-picker/latest/tui-color-picker.css",r.tui+"/tui-image-editor/"+s+"/tui-image-editor.css"]),o.hasRequire?(require.config({paths:{"fabric/dist/fabric.require":r.fabric+"/fabric.require.min",fabric:r.fabric+"/fabric.min","tui-code-snippet":r.tui+"/tui.code-snippet/latest/tui-code-snippet.min","tui-color-picker":r.tui+"/tui-color-picker/latest/tui-color-picker.min","tui-image-editor":r.tui+"/tui-image-editor/"+s+"/tui-image-editor.min"}}),require(["tui-image-editor"],function(e){i.resolve(e)})):o.loadScript([r.fabric+"/fabric.min.js",r.tui+"/tui.code-snippet/latest/tui-code-snippet.min.js"],function(){o.loadScript([r.tui+"/tui-color-picker/latest/tui-color-picker.min.js"],function(){o.loadScript([r.tui+"/tui-image-editor/"+s+"/tui-image-editor.min.js"],function(){i.resolve(window.tui.ImageEditor)},{loadType:"tag"})},{loadType:"tag"})},{loadType:"tag"}),i.done(function(e){n.confObj.editor=e,c(e)})),a},getContent:function(t){var i=this.editor,n=i.fm,o=e(t),a=o.data("quality");if(i.instance)return"image/jpeg"===o.data("mime")&&(a=a||n.storage("jpgQuality")||n.option("jpgQuality"),a=Math.max(.1,Math.min(1,a/100))),i.instance.toDataURL({format:s(o.data("mime"),n),quality:a})},save:function(t){var i,n=e(t),o=n.data("quality"),a=n.data("hash");this.instance.deactivateAll(),"undefined"!=typeof o&&this.fm.storage("jpgQuality",o),a&&(i=this.fm.file(a),n.data("mime",i.mime))}},{info:{id:"pixlreditor",name:"Pixlr Editor",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -128",urlAsContent:!0,schemeContent:!0,single:!0,canMakeEmpty:!0,integrate:{title:"PIXLR EDITOR",link:"https://pixlr.com/editor/"}},mimes:["image/jpeg","image/png","image/gif","image/x-ms-bmp","image/x-pixlr-data"],html:'<div class="elfinder-edit-imageeditor"><img/></div>',setup:function(e,t){m.call(this,e,t)},init:function(e,t,i,n){d.call(this,e,t,t.size>0?n.convAbsUrl(i):"",n)},getContent:function(){return e(this).children("img:first").attr("src")},load:function(e){u.call(this,"editor",e)},save:function(e){},close:function(e){}},{info:{id:"pixlrexpress",name:"Pixlr Express",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -112",urlAsContent:!0,schemeContent:!0,single:!0,canMakeEmpty:!1,integrate:{title:"PIXLR EXPRESS",link:"https://pixlr.com/express/"}},mimes:["image/jpeg","image/png","image/gif"],html:'<div class="elfinder-edit-imageeditor"><img/></div>',setup:function(e,t){m.call(this,e,t)},init:function(e,t,i,n){d.call(this,e,t,t.size>0?n.convAbsUrl(i):"",n)},getContent:function(){return e(this).children("img:first").attr("src")},load:function(e){u.call(this,"express",e)},save:function(e){},close:function(e){}},{info:{id:"photopea",name:"Photopea",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -160",single:!0,noContent:!0,arrayBufferContent:!0,openMaximized:!0,canMakeEmpty:["image/jpeg","image/png","image/gif","image/x-ms-bmp","image/tiff","image/webp","image/vnd.adobe.photoshop","image/x-portable-pixmap","image/x-sketch"],integrate:{title:"Photopea",link:"https://www.photopea.com/learn/"}},mimes:["image/jpeg","image/png","image/gif","image/svg+xml","image/x-ms-bmp","image/tiff","image/x-adobe-dng","image/webp","image/x-xcf","image/vnd.adobe.photoshop","application/pdf","image/x-portable-pixmap","image/x-sketch"],html:'<iframe style="width:100%;height:100%;border:none;"></iframe>',setup:function(e,t){(t.UA.IE||t.UA.Mobile)&&(this.disabled=!0)},init:function(t,i,n,o){var a,c,d,l="https://www.photopea.com",p=e(this).hide().on("load",function(){p.show()}).on("error",function(){f.remove(),p.show()}),m=this.editor,u=m.confObj,f=e('<div class="elfinder-edit-spinner elfinder-edit-photopea"/>').html('<span class="elfinder-spinner-text">'+o.i18n("nowLoading")+'</span><span class="elfinder-spinner"/>').appendTo(p.parent()),g=o.arrayFlip(u.info.canMakeEmpty),h=function(e){var t=s(e,o),i=r[t];return u.mimesFlip[i]?"jpeg"===t&&(t="jpg"):t="",t&&!g[t]||(t="psd",i=r[t],p.closest(".ui-dialog").trigger("changeType",{extention:t,mime:i,keepEditor:!0})),t},v=i.mime;u.mimesFlip||(u.mimesFlip=o.arrayFlip(u.mimes,!0)),u.liveMsg||(u.liveMsg=function(t,i,n){var a=o.openUrl(n.hash);o.isSameOrigin(a)||(a=o.openUrl(n.hash,!0));var r,s=t.get(0).contentWindow,c=0,d=null,p=e.Deferred().done(function(){i.remove(),c=1,s.postMessage(d,"*")});this.load=function(){return o.request({data:{cmd:"get"},options:{url:a,type:"get",cache:!0,dataType:"binary",responseType:"arraybuffer",processData:!1}}).done(function(e){d=e})},this.receive=function(e){var i=e.originalEvent;i.origin===l&&i.source===s&&("done"===i.data?0===c?p.resolve():1===c?(c=2,t.trigger("contentsloaded")):r&&"pending"===r.state()&&r.reject("errDataEmpty"):r&&"pending"===r.state()&&("object"==typeof i.data?r.resolve("data:"+v+";base64,"+o.arrayBufferToBase64(i.data)):r.reject("errDataEmpty")))},this.getContent=function(){var i,n;if(c>1)return r&&"pending"===r.state()&&r.reject(),r=null,r=e.Deferred(),2===c?(c=3,r.resolve("data:"+v+";base64,"+o.arrayBufferToBase64(d)),d=null,r):(t.data("mime")&&(v=t.data("mime"),i=h(v)),(n=t.data("quality"))&&(i+=":"+n/100),s.postMessage('app.activeDocument.saveToOE("'+i+'")',l),r)}}),p.parent().css("padding",0),c=h(i.mime),a=m.liveMsg=new u.liveMsg(p,f,i),e(window).on("message."+o.namespace,a.receive),a.load().done(function(){var e=JSON.stringify({files:[],environment:{lang:o.lang.replace(/_/g,"-")}});p.attr("src",l+"/#"+encodeURI(e))}).fail(function(e){e&&o.error(e),m.initFail=!0}),"image/jpeg"!==i.mime&&"image/webp"!==i.mime||(p.data("quality",o.storage("jpgQuality")||o.option("jpgQuality")),d=e('<input type="number" class="ui-corner-all elfinder-resize-quality elfinder-tabstop"/>').attr("min","1").attr("max","100").attr("title","1 - 100").on("change",function(){var e=d.val();p.data("quality",e)}).val(p.data("quality")),e('<div class="ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality"/>').append(e("<span>").html(o.i18n("quality")+" : "),d,e("<span/>")).prependTo(p.parent().next()))},load:function(t){var i=e.Deferred(),n=this,o=(this.fm,e(t));return n.initFail?i.reject():o.on("contentsloaded",function(){i.resolve(n.liveMsg)}),i},getContent:function(){return this.editor.liveMsg?this.editor.liveMsg.getContent():void 0},save:function(t,i){var n,o=e(t),a=o.data("quality"),r=o.data("hash");"undefined"!=typeof a&&this.fm.storage("jpgQuality",a),r?(n=this.fm.file(r),o.data("mime",n.mime)):o.removeData("mime")},close:function(t,i){e(t).attr("src",""),i&&e(window).off("message."+this.fm.namespace,i.receive)}},{info:{id:"pixo",name:"Pixo Editor",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -208",dataScheme:!0,schemeContent:!0,single:!0,canMakeEmpty:!1,integrate:{title:"Pixo Editor",link:"https://pixoeditor.com/privacy-policy/"}},mimes:["image/jpeg","image/png","image/gif","image/svg+xml","image/x-ms-bmp"],html:'<div class="elfinder-edit-imageeditor"><img/></div>',setup:function(e,t){!t.UA.ltIE8&&e.extraOptions&&e.extraOptions.pixo&&e.extraOptions.pixo.apikey?this.editorOpts=e.extraOptions.pixo:this.disabled=!0},init:function(e,t,i,n){d.call(this,e,t,i,n)},getContent:function(){return e(this).children("img:first").attr("src")},load:function(t){var i,n,o,a,r,d=this,l=this.fm,p=e(t),m=p.children("img:first"),u=p.closest(".ui-dialog"),f=l.getUI(),g=e.Deferred(),h=e("#elfinder-pixo-container"),v=function(o){var v;h.length?h.appendTo(h.parent()):(h=e('<div id="elfinder-pixo-container" class="ui-front"/>').css({position:"fixed",top:0,right:0,width:"100%",height:e(window).height(),overflow:"hidden"}).hide().appendTo(f.hasClass("elfinder-fullscreen")?f:"body"),f.on("resize."+l.namespace,function(e,t){e.preventDefault(),e.stopPropagation(),t&&t.fullscreen&&h.appendTo("on"===t.fullscreen?f:"body")}),l.bind("destroy",function(){r&&r.cancelEditing(),h.remove()})),m.on("click",b),v=Object.assign({type:"child",parent:h.get(0),output:{format:"png"},onSave:function(e){var o=e.toBlob().type,r=s(o,l),p=function(e){m.one("load error",function(){m.data("loading")&&m.data("loading")(!0)}).attr("crossorigin","anonymous").attr("src",e)},f=e.toDataURL();m.data("loading")(),delete t._canvas,m.data("ext")!==r?c(f,d.file.mime).done(function(e,o){o&&(t._canvas=a=o,n.trigger("change"),i&&i.show()),p(e)}).fail(function(){u.trigger("changeType",{extention:r,mime:o}),p(f)}):p(f)},onClose:function(){u.removeClass(l.res("class","preventback")),l.toggleMaximize(h,!1),h.hide(),l.toFront(u)}},d.confObj.editorOpts),d.trigger("Prepare",{node:t,editorObj:Pixo,instance:void 0,opts:v}),r=new Pixo.Bridge(v),g.resolve(r),p.on("saveAsFail",b),o&&o()},b=function(){u.addClass(l.res("class","preventback")),l.toggleMaximize(h,!0),l.toFront(h),h.show().data("curhash",d.file.hash),r.edit(m.get(0)),m.data("loading")(!0)};return m.data("loading")(),"image/jpeg"===d.file.mime&&(n=e('<input type="number" class="ui-corner-all elfinder-resize-quality elfinder-tabstop"/>').attr("min","1").attr("max","100").attr("title","1 - 100").on("change",function(){var e=n.val();o&&cancelAnimationFrame(o),o=requestAnimationFrame(function(){a&&a.toBlob(function(e){e&&n.next("span").text(" ("+l.formatSize(e.size)+")")},"image/jpeg",Math.max(Math.min(e,100),1)/100)})}).val(l.storage("jpgQuality")||l.option("jpgQuality")),i=e('<div class="ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality"/>').hide().append(e("<span>").html(l.i18n("quality")+" : "),n,e("<span/>")).prependTo(p.parent().next()),p.data("quty",n)),"undefined"==typeof Pixo?l.loadScript(["https://pixoeditor.com:8443/editor/scripts/bridge.m.js"],function(){v(b)},{loadType:"tag"}):(v(),b()),g},save:function(t){var i,n=this,o=e(t),a=o.children("img:first");t._canvas?(o.data("quty")&&(i=o.data("quty").val(),i&&this.fm.storage("jpgQuality",i)),a.attr("src",t._canvas.toDataURL(n.file.mime,i?Math.max(Math.min(i,100),1)/100:void 0))):"data:"!==a.attr("src").substr(0,5)&&a.attr("src",l(a,this.file.mime))},close:function(e,t){t&&t.destroy()}},{info:{id:"creativecloud",name:"Creative Cloud",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -192",dataScheme:!0,schemeContent:!0,single:!0,canMakeEmpty:!1,integrate:{title:"Adobe Creative Cloud",link:"https://www.adobe.io/apis/creativecloud.html"}},mimes:["image/jpeg","image/png","image/gif","image/svg+xml","image/x-ms-bmp"],html:'<div class="elfinder-edit-imageeditor"><img/></div>',setup:function(e,t){!t.UA.ltIE8&&e.extraOptions&&e.extraOptions.creativeCloudApiKey?this.apiKey=e.extraOptions.creativeCloudApiKey:this.disabled=!0},init:function(e,t,i,n){d.call(this,e,t,i,n)},getContent:function(){return e(this).children("img:first").attr("src")},load:function(t){var i,n,o,a,s=this,c=this.fm,d=e(t),l=d.children("img:first"),p=d.closest(".ui-dialog"),m=c.getUI(),u=e.Deferred(),f=e("#elfinder-aviary-container"),g=function(a){var g,v=function(){var e={zh_TW:"zh_HANT",zh_CN:"zh_HANS"};return e[c.lang]?e[c.lang]:c.lang};f.length?f.appendTo(f.parent()):(f=e('<div id="elfinder-aviary-container" class="ui-front"/>').css({position:"fixed",top:0,right:0,width:"100%",height:e(window).height(),overflow:"auto"}).hide().appendTo(m.hasClass("elfinder-fullscreen")?m:"body"),m.on("resize."+c.namespace,function(e,t){e.preventDefault(),e.stopPropagation(),t&&t.fullscreen&&f.appendTo("on"===t.fullscreen?m:"body")}),c.bind("destroy",function(){f.remove()})),l.on("click",h).data("loading")(),g={apiKey:s.confObj.apiKey,onSave:function(a,s){var d,p=c.arrayFlip(["jpg","png"]);i.showWaitIndicator(),d=s.replace(/.+\.([^.]+)$/,"$1"),p[l.data("ext")]||l.data("ext")===d?l.data("mime",r[l.data("ext")]):(l.closest(".ui-dialog").trigger("changeType",{extention:d,mime:r[d]}),l.data("mime",r[d])),l.on("load error",function(){var i;l.data("loading")(!0),o&&"data:"!==l.attr("src").substr(0,5)&&(i=document.createElement("img"),e(i).attr("crossorigin","anonymous").on("load",function(){n=document.createElement("canvas"),n.width=i.width,n.height=i.height,n.getContext("2d").drawImage(i,0,0),t._canvas=n,o&&o.trigger("change")}),i.src=s)}).attr("crossorigin","anonymous").attr("src",s).data("loading")(),i.close()},onLoad:a||function(){},onClose:function(){p.removeClass(c.res("class","preventback")),c.toggleMaximize(f,!1),e(f).hide()},appendTo:f.get(0),maxSize:2048,language:v(),fileFormat:"png"},s.trigger("Prepare",{node:t,editorObj:Aviary,instance:void 0,opts:g}),i=new Aviary.Feather(g),u.resolve(i),d.on("saveAsFail",h)},h=function(){p.addClass(c.res("class","preventback")),c.toggleMaximize(f,!0),c.toFront(f),e(f).show(),i.launch({image:l.attr("id"),url:l.attr("src")}),l.data("loading")(!0)};return"image/jpeg"===s.file.mime&&(d.data("quality",c.storage("jpgQuality")||c.option("jpgQuality")),o=e('<input type="number" class="ui-corner-all elfinder-resize-quality elfinder-tabstop"/>').attr("min","1").attr("max","100").attr("title","1 - 100").on("change",function(){var e=o.val();d.data("quality",e),a&&cancelAnimationFrame(a),n&&(a=requestAnimationFrame(function(){n.toBlob(function(e){e&&o.next("span").text(" ("+c.formatSize(e.size)+")")},"image/jpeg",Math.max(Math.min(e,100),1)/100)}))}).val(d.data("quality")),e('<div class="ui-dialog-buttonset elfinder-edit-extras elfinder-edit-extras-quality"/>').append(e("<span>").html(c.i18n("quality")+" : "),o,e("<span/>")).prependTo(d.parent().next())),"undefined"==typeof Aviary?c.loadScript(["https://dme0ih8comzn4.cloudfront.net/imaging/v3/editor.js"],function(){g(h)},{loadType:"tag"}):(g(),h()),u},save:function(t){var i=e(t).children("img:first"),n=e(t).data("quality");t._canvas?(n&&this.fm.storage("jpgQuality",n),i.attr("src",t._canvas.toDataURL(i.data("mime"),n?Math.max(Math.min(n,100),1)/100:void 0))):"data:"!==i.attr("src").substr(0,5)&&i.attr("src",l(i,i.data("mime")))}},{setup:function(e,t){!t.UA.ltIE8&&t.options.cdns.ace||(this.disabled=!0)},info:{id:"aceeditor",name:"ACE Editor",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -96"},load:function(t){var i=this,n=this.fm,o=e.Deferred(),a=n.options.cdns.ace,r=function(){var n,r,s,c=e(t),d=c.parent(),l=d.parent(),p=t.id+"_ace",m=(i.file.name.replace(/^.+\.([^.]+)|(.+)$/,"$1$2").toLowerCase(),{"text/x-php":"php","application/x-php":"php","text/html":"html","application/xhtml+xml":"html","text/javascript":"javascript","application/javascript":"javascript","text/css":"css","text/x-c":"c_cpp","text/x-csrc":"c_cpp","text/x-chdr":"c_cpp","text/x-c++":"c_cpp","text/x-c++src":"c_cpp","text/x-c++hdr":"c_cpp","text/x-shellscript":"sh","application/x-csh":"sh","text/x-python":"python","text/x-java":"java","text/x-java-source":"java","text/x-ruby":"ruby","text/x-perl":"perl","application/x-perl":"perl","text/x-sql":"sql","text/xml":"xml","application/docbook+xml":"xml","application/xml":"xml"});d.height(d.height()),ace.config.set("basePath",a),r=e('<div id="'+p+'" style="width:100%; height:100%;"/>').text(c.val()).insertBefore(c.hide()),c.data("ace",!0),n=ace.edit(p),n.$blockScrolling=1/0,n.setOptions({theme:"ace/theme/monokai",fontSize:"14px",wrap:!0}),ace.config.loadModule("ace/ext/modelist",function(){s=ace.require("ace/ext/modelist").getModeForPath("/"+i.file.name).name,"text"===s&&m[i.file.mime]&&(s=m[i.file.mime]),d.prev().children(".elfinder-dialog-title").append(" ("+i.file.mime+" : "+s.split(/[\/\\]/).pop()+")"),n.setOptions({mode:"ace/mode/"+s}),"resolved"===o.state()&&l.trigger("resize")}),ace.config.loadModule("ace/ext/language_tools",function(){ace.require("ace/ext/language_tools"),n.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1})}),ace.config.loadModule("ace/ext/settings_menu",function(){ace.require("ace/ext/settings_menu").init(n)}),n.commands.addCommand({name:"saveFile",bindKey:{win:"Ctrl-s",mac:"Command-s"},exec:function(e){i.doSave()}}),n.commands.addCommand({name:"closeEditor",bindKey:{win:"Ctrl-w|Ctrl-q",mac:"Command-w|Command-q"},exec:function(e){i.doCancel()}}),n.resize(),e('<div class="ui-dialog-buttonset"/>').css("float","left").append(e("<button/>").html(i.fm.i18n("TextArea")).button().on("click",function(){c.data("ace")?(c.removeData("ace"),r.hide(),c.val(n.session.getValue()).show().trigger("focus"),e(this).text("AceEditor")):(c.data("ace",!0),r.show(),n.setValue(c.hide().val(),-1),n.focus(),e(this).html(i.fm.i18n("TextArea")))})).append(e("<button>Ace editor setting</button>").button({icons:{primary:"ui-icon-gear",secondary:"ui-icon-triangle-1-e"},text:!1}).on("click",function(){n.showSettingsMenu(),e("#ace_settingsmenu").css("font-size","80%").find('div[contains="setOptions"]').hide().end().parent().appendTo(e("#elfinder"))})).prependTo(d.next()),i.trigger("Prepare",{node:t,editorObj:ace,instance:n,opts:{}}),o.resolve(n)};return i.confObj.loader||(i.confObj.loader=e.Deferred(),i.fm.loadScript([a+"/ace.js"],function(){i.confObj.loader.resolve()},void 0,{obj:window,name:"ace"})),i.confObj.loader.done(r),o},close:function(e,t){t&&t.destroy()},save:function(t,i){i&&e(t).data("ace")&&(t.value=i.session.getValue())},focus:function(t,i){i&&e(t).data("ace")&&i.focus()},resize:function(e,t,i,n){t&&t.resize()}},{setup:function(e,t){!t.UA.ltIE10&&t.options.cdns.codemirror||(this.disabled=!0)},info:{id:"codemirror",name:"CodeMirror",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -176"},load:function(t){var i=this.fm,n=i.convAbsUrl(i.options.cdns.codemirror),a=e.Deferred(),r=this,s=function(i){var s,c,d,l=e(t),p=l.parent();p.height(p.height()),d={lineNumbers:!0,lineWrapping:!0,extraKeys:{"Ctrl-S":function(){r.doSave()},"Ctrl-Q":function(){r.doCancel()},"Ctrl-W":function(){r.doCancel()}}},r.trigger("Prepare",{node:t,editorObj:i,instance:void 0,opts:d}),s=i.fromTextArea(t,d),a.resolve(s);var m,u,f,g;m||(m=i.findModeByMIME(r.file.mime)),!m&&(u=r.file.name.match(/.+\.([^.]+)$/))&&(m=i.findModeByExtension(u[1])),m&&(i.modeURL=o?"codemirror/mode/%N/%N.min":n+"/mode/%N/%N.min.js",f=m.mode,g=m.mime,s.setOption("mode",g),i.autoLoadMode(s,f),p.prev().children(".elfinder-dialog-title").append(" ("+g+" : "+f+")")),c=e(s.getWrapperElement()).css({padding:0,border:"none"}),l.data("cm",!0),c.height("100%"),e('<div class="ui-dialog-buttonset"/>').css("float","left").append(e("<button/>").html(r.fm.i18n("TextArea")).button().on("click",function(){l.data("cm")?(l.removeData("cm"),c.hide(),l.val(s.getValue()).show().trigger("focus"),e(this).text("CodeMirror")):(l.data("cm",!0),c.show(),s.setValue(l.hide().val()),s.refresh(),s.focus(),e(this).html(r.fm.i18n("TextArea")))})).prependTo(p.next())};return r.confObj.loader||(r.confObj.loader=e.Deferred(),o?(require.config({packages:[{name:"codemirror",location:n,main:"codemirror.min"}],map:{codemirror:{"codemirror/lib/codemirror":"codemirror"}}}),require(["codemirror","codemirror/addon/mode/loadmode.min","codemirror/mode/meta.min"],function(e){r.confObj.loader.resolve(e)})):r.fm.loadScript([n+"/codemirror.min.js"],function(){r.fm.loadScript([n+"/addon/mode/loadmode.min.js",n+"/mode/meta.min.js"],function(){r.confObj.loader.resolve(CodeMirror)})},{loadType:"tag"}),r.fm.loadCss(n+"/codemirror.css")),r.confObj.loader.done(s),a},close:function(e,t){t&&t.toTextArea()},save:function(t,i){i&&e(t).data("cm")&&(t.value=i.getValue())},focus:function(t,i){i&&e(t).data("cm")&&i.focus()},resize:function(e,t,i,n){t&&t.refresh()}},{setup:function(e,t){!t.UA.ltIE10&&t.options.cdns.simplemde||(this.disabled=!0)},info:{id:"simplemde",name:"SimpleMDE",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -80"},exts:["md"],load:function(t){var i=this,n=this.fm,a=e(t).parent(),r=e.Deferred(),s=n.options.cdns.simplemde,c=function(n){var o,s,c,d=a.height(),l=a.outerHeight(!0)-d+14;t._setHeight=function(t){var i,n=t||a.height(),r=0;return a.children(".editor-toolbar,.editor-statusbar").each(function(){r+=e(this).outerHeight(!0)}),i=n-r-l,s.height(i),o.codemirror.refresh(),i},a.height(d),c={element:t,autofocus:!0},i.trigger("Prepare",{node:t,editorObj:n,instance:void 0,opts:c}),o=new n(c),r.resolve(o),s=e(o.codemirror.getWrapperElement()),s.css("min-height","50px").children(".CodeMirror-scroll").css("min-height","50px"),t._setHeight(d)};return i.confObj.loader||(i.confObj.loader=e.Deferred(),i.fm.loadCss(s+"/simplemde.min.css"),o?require([s+"/simplemde.min.js"],function(e){i.confObj.loader.resolve(e)}):i.fm.loadScript([s+"/simplemde.min.js"],function(){i.confObj.loader.resolve(SimpleMDE)},{loadType:"tag"})),i.confObj.loader.done(c),r},close:function(e,t){t&&t.toTextArea(),t=null},save:function(e,t){t&&(e.value=t.value())},focus:function(e,t){t&&t.codemirror.focus()},resize:function(e,t,i,n){t&&e._setHeight()}},{info:{id:"ckeditor",name:"CKEditor",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 0"},exts:["htm","html","xhtml"],setup:function(e,t){var i=this;t.options.cdns.ckeditor?(i.ckeOpts={},e.extraOptions&&(i.ckeOpts=Object.assign({},e.extraOptions.ckeditor||{}),e.extraOptions.managerUrl&&(i.managerUrl=e.extraOptions.managerUrl))):i.disabled=!0},load:function(t){var i=this,n=this.fm,o=e.Deferred(),a=function(){var a,r=e(t).parent(),s=r.closest(".elfinder-dialog"),c=r.height(),d=/([&?]getfile=)[^&]+/,l=i.confObj.managerUrl||window.location.href.replace(/#.*$/,""),p="ckeditor";d.test(l)?l=l.replace(d,"$1"+p):l+="?getfile="+p,r.height(c),a={startupFocus:!0,fullPage:!0,allowedContent:!0,filebrowserBrowseUrl:l,toolbarCanCollapse:!0,toolbarStartupExpanded:!n.UA.Mobile,removePlugins:"resize",extraPlugins:"colorbutton,justify,docprops",on:{instanceReady:function(e){var a=e.editor;a.resize("100%",c),s.one("beforedommove."+n.namespace,function(){a.destroy()}).one("dommove."+n.namespace,function(){i.load(t).done(function(e){i.instance=e})}),o.resolve(e.editor)}}},i.trigger("Prepare",{node:t,editorObj:CKEDITOR,instance:void 0,opts:a}),CKEDITOR.replace(t.id,Object.assign(a,i.confObj.ckeOpts)),CKEDITOR.on("dialogDefinition",function(t){var i=t.data.definition.dialog;i.on("show",function(t){n.getUI().append(e(".cke_dialog_background_cover")).append(this.getElement().$)}),i.on("hide",function(t){e("body:first").append(e(".cke_dialog_background_cover")).append(this.getElement().$)})})};return i.confObj.loader||(i.confObj.loader=e.Deferred(),window.CKEDITOR_BASEPATH=n.options.cdns.ckeditor+"/",e.getScript(n.options.cdns.ckeditor+"/ckeditor.js",function(){i.confObj.loader.resolve()})),i.confObj.loader.done(a),o},close:function(e,t){t&&t.destroy()},save:function(e,t){t&&(e.value=t.getData())},focus:function(e,t){t&&t.focus()},resize:function(t,i,n,o){i&&"ready"===i.status&&i.resize("100%",e(t).parent().height())}},{info:{id:"ckeditor5",name:"CKEditor5",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -16"},exts:["htm","html","xhtml"],html:'<div class="edit-editor-ckeditor5"></div>',setup:function(e,t){var i=this;t.options.cdns.ckeditor5&&"function"==typeof window.Symbol&&"symbol"==typeof Symbol()?(i.ckeOpts={},
e.extraOptions&&(e.extraOptions.ckeditor5Mode&&(i.ckeditor5Mode=e.extraOptions.ckeditor5Mode),i.ckeOpts=Object.assign({},e.extraOptions.ckeditor5||{}),i.ckeOpts.mode&&(i.ckeditor5Mode=i.ckeOpts.mode,delete i.ckeOpts.mode),e.extraOptions.managerUrl&&(i.managerUrl=e.extraOptions.managerUrl))):i.disabled=!0,t.bind("destroy",function(){i.editor=null})},prepare:function(t,i,n){e(t).height(t.editor.fm.getUI().height()-100)},init:function(e,t,i,n){var o=i.match(/^([\s\S]*<body[^>]*>)([\s\S]+)(<\/body>[\s\S]*)$/i),a="",r="",s="";this.css({width:"100%",height:"100%","box-sizing":"border-box"}),o?(a=o[1],r=o[2],s=o[3]):r=i,this.data("data",{header:a,body:r,footer:s})},load:function(t){var i,n=this,o=this.fm,a=e.Deferred(),r=n.confObj.ckeditor5Mode||"inline",s=function(){var e=o.lang.toLowerCase().replace("_","-");return"zh"===e.substr(0,2)&&"zh-cn"!==e&&(e="zh"),e}(),c=function(i){var c,l=e(t).parent();l.height(o.getUI().height()-100),c=Object.assign({language:s},n.confObj.ckeOpts),n.trigger("Prepare",{node:t,editorObj:i,instance:void 0,opts:c}),i.create(t,c).then(function(i){var n,s,c=i.commands.get("ckfinder"),p=i.plugins.get("FileRepository"),m={};!i.ui.view.toolbar||"classic"!==r&&"decoupled-document"!==r||e(t).closest(".elfinder-dialog").children(".ui-widget-header").append(i.ui.view.toolbar.element),"classic"===r&&e(t).closest(".elfinder-edit-editor").css("overflow","auto"),c&&(n=function(e){return e&&e.mime.match(/^image\//i)},s=function(e){var t=i.commands.get("imageUpload");if(!t.isEnabled){var n=i.plugins.get("Notification"),o=i.locale.t;return void n.showWarning(o("Could not insert image at the current position."),{title:o("Inserting image failed"),namespace:"ckfinder"})}i.execute("imageInsert",{source:e})},c.execute=function(){var t=l.closest(".elfinder-dialog"),a=o.getCommand("getfile"),r=function(){m.hasVar&&(t.off("resize close",r),a.callback=m.callback,a.options.folders=m.folders,a.options.multiple=m.multi,o.commandMap.open=m.open,m.hasVar=!1)};t.trigger("togleminimize").one("resize close",r),m.callback=a.callback,m.folders=a.options.folders,m.multi=a.options.multiple,m.open=o.commandMap.open,m.hasVar=!0,a.callback=function(a){var r=[];return 1===a.length&&"directory"===a[0].mime?void o.one("open",function(){o.commandMap.open="getfile"}).getCommand("open").exec(a[0].hash):(o.getUI("cwd").trigger("unselectall"),e.each(a,function(e,t){n(t)?r.push(o.convAbsUrl(t.url)):i.execute("link",o.convAbsUrl(t.url))}),r.length&&s(r),void t.trigger("togleminimize"))},a.options.folders=!0,a.options.multiple=!0,o.commandMap.open="getfile",o.toast({mode:"info",msg:o.i18n("dblclickToSelect")})}),p.createUploadAdapter=function(e){return new d(e)},i.setData(e(t).data("data").body),o.getUI().append(e("body > div.ck-body")),e("div.ck-balloon-panel").css({"z-index":o.getMaximizeCss().zIndex+1}),a.resolve(i)})["catch"](function(e){o.error(e)})},d=function(e){var t=function(t,i,n){o.exec("upload",{files:[t]},void 0,o.cwd().hash).done(function(e){e.added&&e.added.length?o.url(e.added[0].hash,{async:!0}).done(function(e){i({"default":o.convAbsUrl(e)})}).fail(function(){n("errFileNotFound")}):n(o.i18n(e.error?e.error:"errUpload"))}).fail(function(e){var t=o.parseError(e);n(o.i18n(t?"userabort"===t?"errAbort":t:"errUploadNoFiles"))}).progress(function(t){e.uploadTotal=t.total,e.uploaded=t.progress})};this.upload=function(){return new Promise(function(i,n){e.file instanceof Promise||e.file&&"function"==typeof e.file.then?e.file.then(function(e){t(e,i,n)}):t(e.file,i,n)})},this.abort=function(){o.getUI().trigger("uploadabort")}};return n.confObj.editor?c(n.confObj.editor):(i=e.Deferred(),n.fm.loadScript([o.options.cdns.ckeditor5+"/"+r+"/ckeditor.js"],function(e){e||(e=window.BalloonEditor||window.InlineEditor||window.ClassicEditor||window.DecoupledEditor),"en"!==o.lang?n.fm.loadScript([o.options.cdns.ckeditor5+"/"+r+"/translations/"+s+".js"],function(t){i.resolve(e)},{tryRequire:!0,loadType:"tag",error:function(t){s="en",i.resolve(e)}}):i.resolve(e)},{tryRequire:!0,loadType:"tag"}),i.done(function(e){n.confObj.editor=e,c(e)})),a},getContent:function(){var t=e(this).data("data");return t.header+t.body+t.footer},close:function(e,t){t&&t.destroy()},save:function(t,i){var n=e(t),o=n.data("data");i&&(o.body=i.getData(),n.data("data",o))},focus:function(t,i){e(t).trigger("focus")}},{info:{id:"tinymce",name:"TinyMCE",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -64"},exts:["htm","html","xhtml"],setup:function(e,t){var i=this;t.options.cdns.tinymce?(i.mceOpts={},e.extraOptions?(i.uploadOpts=Object.assign({},e.extraOptions.uploadOpts||{}),i.mceOpts=Object.assign({},e.extraOptions.tinymce||{})):i.uploadOpts={}):i.disabled=!0},load:function(t){var i=this,n=this.fm,o=e.Deferred(),a=function(){var a,r,s,c=e(t).show().parent(),d=c.closest(".elfinder-dialog"),l=c.height(),p=c.outerHeight(!0)-l,m=function(){var t;tinymce.activeEditor.windowManager.windows?(t=tinymce.activeEditor.windowManager.windows[0],r=e(t?t.getEl():void 0).hide(),s=e("#mce-modal-block").hide()):r=e(".tox-dialog-wrap").hide()},u=function(){s&&s.show(),r&&r.show()},f=tinymce.majorVersion;c.height(l),t._setHeight=function(t){if(f<5){var i,n=e(this).parent(),o=t||n.innerHeight(),a=0;n.find(".mce-container-body:first").children(".mce-top-part,.mce-statusbar").each(function(){a+=e(this).outerHeight(!0)}),i=o-a-p,n.find(".mce-edit-area iframe:first").height(i)}},a={selector:"#"+t.id,resize:!1,plugins:"print preview fullpage searchreplace autolink directionality visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern help",toolbar:"formatselect | bold italic strikethrough forecolor backcolor | link image media | alignleft aligncenter alignright alignjustify | numlist bullist outdent indent | removeformat",image_advtab:!0,init_instance_callback:function(e){t._setHeight(l),d.one("beforedommove."+n.namespace,function(){tinymce.execCommand("mceRemoveEditor",!1,t.id)}).one("dommove."+n.namespace,function(){i.load(t).done(function(e){i.instance=e})}),o.resolve(e)},file_picker_callback:function(e,t,i){var o=n.getCommand("getfile"),a=function(){r.hasVar&&(o.callback=r.callback,o.options.folders=r.folders,o.options.multiple=r.multi,n.commandMap.open=r.open,r.hasVar=!1),d.off("resize close",a),u()},r={};return r.callback=o.callback,r.folders=o.options.folders,r.multi=o.options.multiple,r.open=n.commandMap.open,r.hasVar=!0,o.callback=function(t){var o,a;return"directory"===t.mime?void n.one("open",function(){n.commandMap.open="getfile"}).getCommand("open").exec(t.hash):(o=n.convAbsUrl(t.url),a=t.name+" ("+n.formatSize(t.size)+")","file"==i.filetype&&e(o,{text:a,title:a}),"image"==i.filetype&&e(o,{alt:a}),"media"==i.filetype&&e(o),void d.trigger("togleminimize"))},o.options.folders=!0,o.options.multiple=!1,n.commandMap.open="getfile",m(),d.trigger("togleminimize").one("resize close",a),n.toast({mode:"info",msg:n.i18n("dblclickToSelect")}),!1},images_upload_handler:function(e,t,o){var a=e.blob(),r=function(e){var t=e.data.dialog||{};(t.hasClass("elfinder-dialog-error")||t.hasClass("elfinder-confirm-upload"))&&(m(),t.trigger("togleminimize").one("resize close",s),n.unbind("dialogopened",r))},s=function(){d.off("resize close",s),u()},c=!0;a.name&&(c=void 0),n.bind("dialogopened",r).exec("upload",Object.assign({files:[a],clipdata:c},i.confObj.uploadOpts),void 0,n.cwd().hash).done(function(e){e.added&&e.added.length?n.url(e.added[0].hash,{async:!0}).done(function(e){u(),t(n.convAbsUrl(e))}).fail(function(){o(n.i18n("errFileNotFound"))}):o(n.i18n(e.error?e.error:"errUpload"))}).fail(function(e){var t=n.parseError(e);t&&("errUnknownCmd"===t?t="errPerm":"userabort"===t&&(t="errAbort")),o(n.i18n(t?t:"errUploadNoFiles"))})}},f>=5&&(a.height="100%"),i.trigger("Prepare",{node:t,editorObj:tinymce,instance:void 0,opts:a}),tinymce.init(Object.assign(a,i.confObj.mceOpts))};return i.confObj.loader||(i.confObj.loader=e.Deferred(),i.fm.loadScript([n.options.cdns.tinymce+(n.options.cdns.tinymce.match(/\.js/)?"":"/tinymce.min.js")],function(){i.confObj.loader.resolve()},{loadType:"tag"})),i.confObj.loader.done(a),o},close:function(e,t){t&&tinymce.execCommand("mceRemoveEditor",!1,e.id)},save:function(e,t){t&&t.save()},focus:function(e,t){t&&t.focus()},resize:function(e,t,i,n){t&&e._setHeight()}},{info:{id:"zohoeditor",name:"Zoho Editor",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -32",cmdCheck:"ZohoOffice",preventGet:!0,hideButtons:!0,syncInterval:15e3,canMakeEmpty:!0,integrate:{title:"Zoho Office API",link:"https://www.zoho.com/officeapi/"}},mimes:["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.oasis.opendocument.text","application/rtf","text/html","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.spreadsheet","application/vnd.sun.xml.calc","text/csv","text/tab-separated-values","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.oasis.opendocument.presentation","application/vnd.sun.xml.impress"],html:'<iframe style="width:100%;max-height:100%;border:none;"></iframe>',setup:function(e,t){(t.UA.Mobile||t.UA.ltIE8)&&(this.disabled=!0)},prepare:function(t,i,n){var o=t.editor.fm.getUI();e(t).height(o.height()),i.width=Math.max(i.width||0,.8*o.width())},init:function(t,i,n,o){var a=this,r=e(this).hide(),s=o.getUI("toast"),c=e('<div class="elfinder-edit-spinner elfinder-edit-zohoeditor"/>').html('<span class="elfinder-spinner-text">'+o.i18n("nowLoading")+'</span><span class="elfinder-spinner"/>').appendTo(r.parent()),d=function(){var t="";return e.each(o.customData,function(e,i){t+="&"+encodeURIComponent(e)+"="+encodeURIComponent(i)}),t};e(a).data("xhr",o.request({data:{cmd:"editor",name:a.editor.confObj.info.cmdCheck,method:"init","args[target]":i.hash,"args[lang]":o.lang,"args[cdata]":d()},preventDefault:!0}).done(function(e){var t;e.zohourl?(t={css:{height:"100%"}},a.editor.trigger("Prepare",{node:a,editorObj:void 0,instance:r,opts:t}),r.attr("src",e.zohourl).show().css(t.css),e.warning&&(s.appendTo(a.closest(".ui-dialog")),o.toast({msg:o.i18n(e.warning),mode:"warning",timeOut:0,onHidden:function(){1===s.children().length&&s.appendTo(o.getUI())},button:{text:"btnYes"}}))):(e.error&&o.error(e.error),a.elfinderdialog("destroy"))}).fail(function(e){e&&o.error(e),a.elfinderdialog("destroy")}).always(function(){c.remove()}))},load:function(){},getContent:function(){},save:function(){},beforeclose:f,close:function(t){var i=(this.fm,e(t).data("xhr"));"pending"===i.state()&&i.reject()}},{info:{id:"ziparchive",name:"btnMount",iconImg:fm_menu_icon_base_url+"img/toolbar.png 0 -416",cmdCheck:"ZipArchive",edit:function(t,i){var n=this,o=e.Deferred();return n.request({data:{cmd:"netmount",protocol:"ziparchive",host:t.hash,path:t.phash},notify:{type:"netmount",cnt:1,hideCnt:!0}}).done(function(e){var t;e.added&&e.added.length&&(e.added[0].phash&&(t=n.file(e.added[0].phash))&&(t.dirs||(t.dirs=1,n.change({changed:[t]}))),n.one("netmountdone",function(){n.exec("open",e.added[0].hash),n.one("opendone",function(){e.toast&&n.toast(e.toast)})})),o.resolve()}).fail(function(e){o.reject(e)}),o}},mimes:["application/zip"],load:function(){},save:function(){}},{info:{id:"textarea",name:"TextArea",useTextAreaEvent:!0},load:function(t){this.trigger("Prepare",{node:t,editorObj:void 0,instance:void 0,opts:{}}),t.setSelectionRange&&t.setSelectionRange(0,0),e(t).trigger("focus").show()},save:function(){}},{info:{id:"onlineconvert",name:"Online Convert",iconImg:fm_menu_icon_base_url+"img/editor-icons.png 0 -144",cmdCheck:"OnlineConvert",preventGet:!0,hideButtons:!0,single:!0,converter:!0,canMakeEmpty:!1,integrate:{title:"ONLINE-CONVERT.COM",link:"https://online-convert.com"}},mimes:["*"],html:'<iframe style="width:100%;max-height:100%;border:none;"></iframe>',setup:function(t,i){var n=t.extraOptions.onlineConvert||{maxSize:100,showLink:!0};n.maxSize&&(this.info.maxSize=1048576*n.maxSize),this.set=Object.assign({url:"https://%s.online-convert.com%s?external_url=",conv:{Archive:{"7Z":{},BZ2:{ext:"bz"},GZ:{},ZIP:{}},Audio:{MP3:{},OGG:{ext:"oga"},WAV:{},WMA:{},AAC:{},AIFF:{ext:"aif"},FLAC:{},M4A:{},MMF:{},OPUS:{ext:"oga"}},Document:{DOC:{},DOCX:{},HTML:{},ODT:{},PDF:{},PPT:{},PPTX:{},RTF:{},SWF:{},TXT:{}},eBook:{AZW3:{ext:"azw"},ePub:{},FB2:{ext:"xml"},LIT:{},LRF:{},MOBI:{},PDB:{},PDF:{},"PDF-eBook":{ext:"pdf"},TCR:{}},Hash:{Adler32:{},"Apache-htpasswd":{},Blowfish:{},CRC32:{},CRC32B:{},Gost:{},Haval128:{},MD4:{},MD5:{},RIPEMD128:{},RIPEMD160:{},SHA1:{},SHA256:{},SHA384:{},SHA512:{},Snefru:{},"Std-DES":{},Tiger128:{},"Tiger128-calculator":{},"Tiger128-converter":{},Tiger160:{},Tiger192:{},Whirlpool:{}},Image:{BMP:{},EPS:{ext:"ai"},GIF:{},EXR:{},ICO:{},JPG:{},PNG:{},SVG:{},TGA:{},TIFF:{ext:"tif"},WBMP:{},WebP:{}},Video:{"3G2":{},"3GP":{},AVI:{},FLV:{},HLS:{ext:"m3u8"},MKV:{},MOV:{},MP4:{},"MPEG-1":{ext:"mpeg"},"MPEG-2":{ext:"mpeg"},OGG:{ext:"ogv"},OGV:{},WebM:{},WMV:{},Android:{link:"/convert-video-for-%s",ext:"mp4"},Blackberry:{link:"/convert-video-for-%s",ext:"mp4"},DPG:{link:"/convert-video-for-%s",ext:"avi"},iPad:{link:"/convert-video-for-%s",ext:"mp4"},iPhone:{link:"/convert-video-for-%s",ext:"mp4"},iPod:{link:"/convert-video-for-%s",ext:"mp4"},"Nintendo-3DS":{link:"/convert-video-for-%s",ext:"avi"},"Nintendo-DS":{link:"/convert-video-for-%s",ext:"avi"},PS3:{link:"/convert-video-for-%s",ext:"mp4"},Wii:{link:"/convert-video-for-%s",ext:"avi"},Xbox:{link:"/convert-video-for-%s",ext:"wmv"}}},catExts:{Hash:"txt"},link:'<div class="elfinder-edit-onlineconvert-link"><a href="https://www.online-convert.com" target="_blank"><span class="elfinder-button-icon"></span>ONLINE-CONVERT.COM</a></div>',useTabs:!(!e.fn.tabs||i.UA.iOS)},n)},prepare:function(t,i,n){var o=t.editor.fm.getUI();e(t).height(o.height()),i.width=Math.max(i.width||0,.8*o.width())},init:function(t,i,n,o){var a,s,c=this,d=c.editor.confObj,l=d.set,p=o.getUI("toast"),m={},u=o.uploadMimeCheck("application/zip",i.phash),f=e("base").length?document.location.href.replace(/#.*$/,""):"",g=function(e,t){var i;return l.catExts[e]?l.catExts[e]:l.conv[e]&&(i=l.conv[e][t])?(i.ext||t).toLowerCase():t.toLowerCase()},h=function(t,i){var n,a,r;a="undefined"==typeof d.api?o.request({data:{cmd:"editor",name:"OnlineConvert",method:"init"},preventDefault:!0}):e.Deferred().resolve({api:d.api}),t=t.toLowerCase(),a.done(function(o){d.api=o.api,d.api&&(t?n="?category="+t:(n="",t="all"),d.conversions||(d.conversions={}),r=d.conversions[t]?e.Deferred().resolve(d.conversions[t]):e.getJSON("https://api2.online-convert.com/conversions"+n),r.done(function(n){d.conversions[t]=n,e.each(n,function(e,t){v[l.useTabs?"children":"find"](".onlineconvert-category-"+t.category).children(".onlineconvert-"+t.target).trigger("makeoption",t)}),i&&i()}))})},v=function(){var t=e("<div/>").on("click","button",function(){var t=e(this),i=t.data("opts")||null,n=t.closest(".onlineconvert-category").data("cname"),o=t.data("conv");d.api===!0?k({category:n,convert:o,options:i}):I(n,o)}).on("change",function(t){var i=e(t.target),n=i.parent(),a=i.closest(".elfinder-edit-onlineconvert-button").children("button:first"),r=a.data("opts")||{},s="boolean"===n.data("type")?i.is(":checked"):i.val();if(t.stopPropagation(),s&&("integer"===n.data("type")&&(s=parseInt(s)),n.data("pattern"))){var c=new RegExp(n.data("pattern"));c.test(s)||(requestAnimationFrame(function(){o.error('"'+o.escape(s)+'" is not match to "/'+o.escape(n.data("pattern"))+'/"')}),s=null)}s?r[i.parent().data("optkey")]=s:delete r[n.data("optkey")],a.data("opts",r)}),n=e("<ul/>"),a=function(t,i){var n,a,r,s=e("<p/>").data("optkey",t).data("type",i.type),c="",d="",l=!1;return i.description&&s.attr("title",o.i18n(i.description)),i.pattern&&s.data("pattern",i.pattern),s.append(e("<span/>").text(o.i18n(t)+" : ")),"boolean"===i.type?((i["default"]||(l="allow_multiple_outputs"===t&&!u))&&(c=" checked",l&&(d=" disabled"),a=this.children("button:first"),n=a.data("opts")||{},n[t]=!0,a.data("opts",n)),s.append(e('<input type="checkbox" value="true"'+c+d+"/>"))):i["enum"]?(r=e("<select/>").append(e('<option value=""/>').text("Select...")),e.each(i["enum"],function(t,i){r.append(e('<option value="'+i+'"/>').text(i))}),s.append(r)):s.append(e('<input type="text" value=""/>')),s},s=function(t){var i=this,n=e('<span class="elfinder-button-icon elfinder-button-icon-preference"/>').on("click",function(){o.toggle()}),o=e('<div class="elfinder-edit-onlinconvert-options"/>').hide();t.options&&e.each(t.options,function(e,t){"download_password"!==e&&o.append(a.call(i,e,t))}),i.append(n,o)},c=+new Date,p=0;return d.ext2mime||(d.ext2mime=Object.assign(o.arrayFlip(o.mimeTypes),r)),e.each(l.conv,function(a,r){var l=a.toLowerCase(),u="elfinder-edit-onlineconvert-"+l+c,h=e('<div id="'+u+'" class="onlineconvert-category onlineconvert-category-'+l+'"/>').data("cname",a);e.each(r,function(t,n){var r=t.toLowerCase(),c=g(a,t);d.ext2mime[c]||("audio"===l||"image"===l||"video"===l?d.ext2mime[c]=l+"/x-"+r:d.ext2mime[c]="application/octet-stream"),o.uploadMimeCheck(d.ext2mime[c],i.phash)&&h.append(e('<div class="elfinder-edit-onlineconvert-button onlineconvert-'+r+'"/>').on("makeoption",function(t,i){var n=e(this);n.children(".elfinder-button-icon-preference").length||s.call(n,i)}).append(e("<button/>").text(t).data("conv",t)))}),h.children().length&&(n.append(e("<li/>").append(e("<a/>").attr("href",f+"#"+u).text(a))),t.append(h),m[l]=p++)}),l.useTabs?t.prepend(n).tabs({beforeActivate:function(e,t){h(t.newPanel.data("cname"))}}):e.each(l.conv,function(i){var n=i.toLowerCase();t.append(e('<fieldset class="onlineconvert-fieldset-'+n+'"/>').append(e("<legend/>").text(i)).append(t.children(".onlineconvert-category-"+n)))}),t}(),b=e(this).hide(),x=e("<div/>").append(v,e('<div class="elfinder-edit-onlineconvert-bottom-btn"/>').append(e("<button/>").addClass(o.UA.iOS?"elfinder-button-ios-multiline":"").html(o.i18n("convertOn","Online-Convert.com")).on("click",function(){I()})),l.showLink?e(l.link):null).appendTo(b.parent().css({overflow:"auto"})),y=e('<div class="elfinder-edit-spinner elfinder-edit-onlineconvert"/>').hide().html('<span class="elfinder-spinner-text">'+o.i18n("nowLoading")+'</span><span class="elfinder-spinner"/>').appendTo(b.parent()),w=null,O=function(){return w?e.Deferred().resolve(w):(y.show(),o.forExternalUrl(i.hash).done(function(e){w=e}).fail(function(e){e&&o.error(e),c.elfinderdialog("destroy")}).always(function(){y.hide()}))},k=function(t){e(c).data("dfrd",O().done(function(e){x.fadeOut(),C({info:"Start conversion request."}),o.request({data:{cmd:"editor",name:"OnlineConvert",method:"api","args[category]":t.category.toLowerCase(),"args[convert]":t.convert.toLowerCase(),"args[options]":JSON.stringify(t.options),"args[source]":o.convAbsUrl(e),"args[filename]":o.splitFileExtention(i.name)[0]+"."+g(t.category,t.convert),"args[mime]":i.mime},preventDefault:!0}).done(function(e){j(e.apires,t.category,t.convert)}).fail(function(e){e&&o.error(e),c.elfinderdialog("destroy")})}))},j=function(t,i,n){var a,r=[];t&&t.id?(a=t.status,"failed"===a.code?(y.hide(),t.errors&&t.errors.length&&e.each(t.errors,function(e,t){t.message&&r.push(t.message)}),o.error(r.length?r:a.info),x.fadeIn()):"completed"===a.code?T(t):(C(a),setTimeout(function(){_(t.id)},1e3))):(p.appendTo(c.closest(".ui-dialog")),t.message&&o.toast({msg:o.i18n(t.message),mode:"error",timeOut:5e3,onHidden:function(){1===p.children().length&&p.appendTo(o.getUI())}}),o.toast({msg:o.i18n("editorConvNoApi"),mode:"warning",timeOut:3e3,onHidden:function(){1===p.children().length&&p.appendTo(o.getUI()),I(i,n)}}))},C=function(e){y.show().children(".elfinder-spinner-text").text(e.info)},_=function(e){o.request({data:{cmd:"editor",name:"OnlineConvert",method:"api","args[jobid]":e},preventDefault:!0}).done(function(e){j(e.apires)}).fail(function(e){e&&o.error(e),c.elfinderdialog("destroy")})},T=function(t){var n=t.output,a=(t.id,"");y.hide(),n&&n.length&&(c.elfinderdialog("destroy"),e.each(n,function(e,t){t.uri&&(a+=t.uri+"\n")}),o.upload({target:i.phash,files:[a],type:"text",extraData:{contentSaveId:"OnlineConvert-"+t.id}}))},I=function(t,i){var n;t&&i?(n=l.conv[t]&&l.conv[t][i]&&l.conv[t][i].link?l.conv[t][i].link.replace("%s",i):"hash"===t?"/"+i+"-generator":"/convert-to-"+i,n=l.url.replace("%s",t).replace("%s",n)):n=l.url.replace("%s",M+"-conversion").replace("%s",""),y.hide(),x.hide(),b.parent().css({overflow:o.UA.iOS?"auto":"hidden"}),e(c).data("dfrd",O().done(function(e){var t;e?(t={css:{height:"100%"}},c.editor.trigger("Prepare",{node:c,editorObj:void 0,instance:b,opts:t}),e=n+encodeURIComponent(o.convAbsUrl(e)),b.attr("src",e).show().css(t.css).one("load",function(){p.appendTo(c.closest(".ui-dialog")),o.toast({msg:o.i18n("editorConvNeedUpload"),mode:"info",timeOut:15e3,onHidden:function(){1===p.children().length&&p.appendTo(o.getUI())},button:{text:"btnYes"}})})):(data.error&&o.error(data.error),c.elfinderdialog("destroy"))}))},M="document";b.parent().addClass("overflow-scrolling-touch"),(s=i.mime.match(/^(audio|image|video)/))&&(M=s[1]),l.useTabs?m[M]&&v.tabs("option","active",m[M]):(a=Object.keys(l.conv).length,e.each(l.conv,function(t){return t.toLowerCase()===M?(h(t,function(){e.each(l.conv,function(e){e.toLowerCase()!==M&&h(e)})}),!1):void a--}),a||e.each(l.conv,function(e){h(e)}),b.parent().scrollTop(v.children(".onlineconvert-fieldset-"+M).offset().top))},load:function(){},getContent:function(){},save:function(){},beforeclose:f,close:function(t){var i=(this.fm,e(t).data("dfrd"));i&&"pending"===i.state()&&i.reject()}}]},window.elFinder)}(jQuery);
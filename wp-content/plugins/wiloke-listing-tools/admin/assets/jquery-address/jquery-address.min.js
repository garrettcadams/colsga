!function(Z){Z.address=function(){var l,r,t,e,n=function(t){var e=Z.extend(Z.Event(t),function(){for(var t={},e=Z.address.parameterNames(),r=0,n=e.length;r<n;r++)t[e[r]]=Z.address.parameter(e[r]);return{value:Z.address.value(),path:Z.address.path(),pathNames:Z.address.pathNames(),parameterNames:e,parameters:t,queryString:Z.address.queryString()}}.call(Z.address));return Z(Z.address).trigger(e),e},a=function(t){return Array.prototype.slice.call(t)},i=function(t,e,r){return Z().bind.apply(Z(Z.address),Array.prototype.slice.call(arguments)),Z.address},s=function(){return L.pushState&&T.state!==l},o=function(){return("/"+C.pathname.replace(new RegExp(T.state),"")+C.search+(c()?"#"+c():"")).replace(_,"/")},c=function(){var t=C.href.indexOf("#");return-1!=t?C.href.substr(t+1):""},u=function(){return s()?o():c()},d=function(){try{return top.document!==l&&top.document.title!==l&&top.jQuery!==l&&top.jQuery.address!==l&&!1!==top.jQuery.address.frames()?top:window}catch(t){return window}},p=function(t){return t=t.toString(),(T.strict&&"/"!=t.substr(0,1)?"/":"")+t},h=function(t,e){return parseInt(t.css(e),10)},f=function(){if(!K){var t=u();decodeURI(V)!=decodeURI(t)&&($&&q<7?C.reload():($&&!B&&T.history&&W(m,50),V=t,v(R)))}},v=function(t){return W(g,10),n(S).isDefaultPrevented()||n(t?j:I).isDefaultPrevented()},g=function(){if("null"!==T.tracker&&T.tracker!==b){var t=Z.isFunction(T.tracker)?T.tracker:O[T.tracker],e=(C.pathname+C.search+(Z.address&&!s()?Z.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");Z.isFunction(t)?t(e):(Z.isFunction(O.urchinTracker)&&O.urchinTracker(e),O.pageTracker!==l&&Z.isFunction(O.pageTracker._trackPageview)&&O.pageTracker._trackPageview(e),O._gaq!==l&&Z.isFunction(O._gaq.push)&&O._gaq.push(["_trackPageview",decodeURI(e)]),Z.isFunction(O.ga)&&O.ga("send","pageview",e))}},m=function(){var t="javascript:"+R+";document.open();document.writeln('<html><head><title>"+F.title.replace(/\'/g,"\\'")+"</title><script>var "+x+' = "'+encodeURIComponent(u()).replace(/\'/g,"\\'")+(F.domain!=C.hostname?'";document.domain="'+F.domain:"")+"\";<\/script></head></html>');document.close();";q<7?r.src=t:r.contentWindow.location.replace(t)},y=function(){if(P&&-1!=Q){var t,e,r=P.substr(Q+1).split("&");for(t=0;t<r.length;t++)e=r[t].split("="),/^(autoUpdate|history|strict|wrap)$/.test(e[0])&&(T[e[0]]=isNaN(e[1])?/^(true|yes)$/i.test(e[1]):0!==parseInt(e[1],10)),/^(state|tracker)$/.test(e[0])&&(T[e[0]]=e[1]);P=b}V=u()},w=function(){if(!G){if(G=U,y(),Z('a[rel*="address:"]').address(),T.wrap){var t=Z("body");Z("body > *").wrapAll('<div style="padding:'+(h(t,"marginTop")+h(t,"paddingTop"))+"px "+(h(t,"marginRight")+h(t,"paddingRight"))+"px "+(h(t,"marginBottom")+h(t,"paddingBottom"))+"px "+(h(t,"marginLeft")+h(t,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+x+'" style="height:100%;overflow:auto;position:relative;'+(N&&!window.statusbar.visible?"resize:both;":"")+'" />');Z("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),N&&Z('<style type="text/css" />').appendTo("head").text("#"+x+"::-webkit-resizer { background-color: #fff; }")}if($&&!B){var e=F.getElementsByTagName("frameset")[0];(r=F.createElement((e?"":"i")+"frame")).src="javascript:"+R,e?(e.insertAdjacentElement("beforeEnd",r),e[e.cols?"cols":"rows"]+=",0",r.noResize=U,r.frameBorder=r.frameSpacing=0):(r.style.display="none",r.style.width=r.style.height=0,r.tabIndex=-1,F.body.insertAdjacentElement("afterBegin",r)),W(function(){Z(r).bind("load",function(){var t=r.contentWindow;(V=t[x]!==l?t[x]:"")!=u()&&(v(R),C.hash=V)}),r.contentWindow[x]===l&&m()},50)}W(function(){n("init"),v(R)},1),s()||($&&7<q||!$&&B?O.addEventListener?O.addEventListener(k,f,R):O.attachEvent&&O.attachEvent("on"+k,f):M(f,50)),"state"in window.history&&Z(window).trigger("popstate")}},b=null,x="jQueryAddress",k="hashchange",E="init",S="change",j="internalChange",I="externalChange",U=!0,R=!1,T={autoUpdate:U,history:U,strict:U,frames:U,wrap:R},A=(t={},(e=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(navigator.userAgent)).browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),t),q=parseFloat(A.version),N=A.webkit||A.safari,$=A.msie,O=d(),F=O.document,L=O.history,C=O.location,M=setInterval,W=setTimeout,_=/\/{2,9}/g,z=navigator.userAgent,B="on"+k in O,P=Z("script:last").attr("src"),Q=P?P.indexOf("?"):-1,D=F.title,K=R,G=R,H=U,J=R,V=u();if($){q=parseFloat(z.substr(z.indexOf("MSIE")+4)),F.documentMode&&F.documentMode!=q&&(q=8!=F.documentMode?7:8);var X=F.onpropertychange;F.onpropertychange=function(){X&&X.call(F),F.title!=D&&-1!=F.title.indexOf("#"+u())&&(F.title=D)}}if(L.navigationMode&&(L.navigationMode="compatible"),"complete"==document.readyState)var Y=setInterval(function(){Z.address&&(w(),clearInterval(Y))},50);else y(),Z(w);return Z(window).bind("popstate",function(){decodeURI(V)!=decodeURI(u())&&(V=u(),v(R))}).bind("unload",function(){O.removeEventListener?O.removeEventListener(k,f,R):O.detachEvent&&O.detachEvent("on"+k,f)}),{bind:function(t,e,r){return i.apply(this,a(arguments))},unbind:function(t,e){return function(t,e){return Z().unbind.apply(Z(Z.address),Array.prototype.slice.call(arguments)),Z.address}.apply(this,a(arguments))},init:function(t,e){return i.apply(this,[E].concat(a(arguments)))},change:function(t,e){return i.apply(this,[S].concat(a(arguments)))},internalChange:function(t,e){return i.apply(this,[j].concat(a(arguments)))},externalChange:function(t,e){return i.apply(this,[I].concat(a(arguments)))},baseURL:function(){var t=C.href;return-1!=t.indexOf("#")&&(t=t.substr(0,t.indexOf("#"))),/\/$/.test(t)&&(t=t.substr(0,t.length-1)),t},autoUpdate:function(t){return t!==l?(T.autoUpdate=t,this):T.autoUpdate},history:function(t){return t!==l?(T.history=t,this):T.history},state:function(t){if(t===l)return T.state;T.state=t;var e=o();return T.state!==l&&(L.pushState?"/#/"==e.substr(0,3)&&C.replace(T.state.replace(/^\/$/,"")+e.substr(2)):"/"!=e&&e.replace(/^\/#/,"")!=c()&&W(function(){C.replace(T.state.replace(/^\/$/,"")+"/#"+e)},1)),this},frames:function(t){return t!==l?(T.frames=t,O=d(),this):T.frames},strict:function(t){return t!==l?(T.strict=t,this):T.strict},tracker:function(t){return t!==l?(T.tracker=t,this):T.tracker},wrap:function(t){return t!==l?(T.wrap=t,this):T.wrap},update:function(){return J=U,this.value(V),J=R,this},title:function(t){return t!==l?(W(function(){D=F.title=t,H&&r&&r.contentWindow&&r.contentWindow.document&&(r.contentWindow.document.title=t,H=R)},50),this):F.title},value:function(t){if(t===l)return p(V);if("/"==(t=p(t))&&(t=""),V!=t||J){if(V=t,T.autoUpdate||J){if(v(U))return this;s()?L[T.history?"pushState":"replaceState"]({},"",T.state.replace(/\/$/,"")+(""===V?"/":V)):(K=U,N?T.history?C.hash="#"+V:C.replace("#"+V):V!=u()&&(T.history?C.hash="#"+V:C.replace("#"+V)),$&&!B&&T.history&&W(m,50),N?W(function(){K=R},1):K=R)}return this}},path:function(t){if(t===l)return p(V).split("#")[0].split("?")[0];var e=this.queryString(),r=this.hash();return this.value(t+(e?"?"+e:"")+(r?"#"+r:"")),this},pathNames:function(){var t=this.path(),e=t.replace(_,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||e.splice(0,1),"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1),e},queryString:function(t){if(t!==l){var e=this.hash();return this.value(this.path()+(t?"?"+t:"")+(e?"#"+e:"")),this}var r=V.split("?");return r.slice(1,r.length).join("?").split("#")[0]},parameter:function(t,e,r){var n,a;if(e!==l){var i=this.parameterNames();for(a=[],e=e===l||e===b?"":e.toString(),n=0;n<i.length;n++){var s=i[n],o=this.parameter(s);"string"==typeof o&&(o=[o]),s==t&&(o=e===b||""===e?[]:r?o.concat([e]):[e]);for(var c=0;c<o.length;c++)a.push(s+"="+o[c])}return-1==Z.inArray(t,i)&&e!==b&&""!==e&&a.push(t+"="+e),this.queryString(a.join("&")),this}if(e=this.queryString()){var u=[];for(a=e.split("&"),n=0;n<a.length;n++){var d=a[n].split("=");d[0]==t&&u.push(d.slice(1).join("="))}if(0!==u.length)return 1!=u.length?u:u[0]}},parameterNames:function(){var t=this.queryString(),e=[];if(t&&-1!=t.indexOf("="))for(var r=t.split("&"),n=0;n<r.length;n++){var a=r[n].split("=")[0];-1==Z.inArray(a,e)&&e.push(a)}return e},hash:function(t){if(t!==l)return this.value(V.split("#")[0]+(t?"#"+t:"")),this;var e=V.split("#");return e.slice(1,e.length).join("#")}}}(),Z.fn.address=function(a){return Z(this).each(function(t){Z(this).data("address")||Z(this).on("click",function(t){if(t.shiftKey||t.ctrlKey||t.metaKey||2==t.which)return!0;var e=t.currentTarget;if(Z(e).is("a")){t.preventDefault();var r=a?a.call(e):/address:/.test(Z(e).attr("rel"))?Z(e).attr("rel").split("address:")[1].split(" ")[0]:void 0===Z.address.state()||/^\/?$/.test(Z.address.state())?Z(e).attr("href").replace(/^(#\!?|\.)/,""):Z(e).attr("href").replace(new RegExp("^(.*"+Z.address.state()+"|\\.)"),"");Z.address.value(r)}}).on("submit",function(t){var e=t.currentTarget;if(Z(e).is("form")){t.preventDefault();var r=Z(e).attr("action"),n=a?a.call(e):(-1!=r.indexOf("?")?r.replace(/&$/,""):r+"?")+Z(e).serialize();Z.address.value(n)}}).data("address",!0)}),this}}(jQuery);
!function(){"use strict";!function(t){t.fn.wilokePostFormatMediaPopup=function(i){var e=t(this),o=t.extend({parent:"",title:"My Photos",button:"Select",multiple:!0,isPreview:!0,buttonClass:null,return:"id",init:function(){},select:function(){}},e.data(),i),a="";return{$el:e,options:o,$button:t(".wiloke-button",e),$input:t(".wiloke-media-value",e),template:'<li class="wiloke-image"><img src="" alt=""/><div class="wiloke-control-wrap"><i class="wiloke-edit dashicons dashicons-edit"></i><i class="wiloke-close dashicons dashicons-no-alt"></i></div></li>',$showImage:"",media:null,init:function(){var t=this;t.options.isPreview&&t.createHTML(),t.setMedia(),t.events()},createHTML:function(){var i=void 0;i=""===this.options.parent?this.$el:t(this.options.parent).length?t(this.options.parent):this.$el,t("ul.list-wiloke-image-media",i).length||i.prepend('<ul class="list-wiloke-image-media"></ul>'),this.options.isPreview||t(".list-wiloke-image-media",i).addClass("hidden"),this.$showImage=t(".list-wiloke-image-media",i)},events:function(){var i=this;i.setValueToInput(),i.options.multiple&&i.options.isPreview&&i.$showImage.sortable({revert:200,containment:"parent",update:function(){i.$input.trigger("change")}}),null!==i.options.buttonClass?e.on("click",i.options.buttonClass,function(o){o.preventDefault(),i.$input=t(".wiloke-media-value",e),i.setValueToInput(),a=i.$showImage,i.media.open()}):i.$button.on("click",function(t){t.preventDefault(),a=i.$showImage,i.media.open()}),i.options.isPreview&&(i.$showImage.on("click",".wiloke-edit",function(e){e.preventDefault(),a=t(this).closest(".wiloke-image"),i.media.open()}),i.$showImage.on("click",".wiloke-close",function(e){e.stopPropagation(),e.preventDefault(),t(this).closest("li").remove(),i.$input.trigger("change")})),i.media.on("select",function(){var e=i.media.state().get("selection");i.options.isPreview?(e.each(function(e,o){var n=(e=e.toJSON()).sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail.url:e.url,l=t(i.template).attr("data-id",e.id).attr("data-url",e.url);t("img",l).attr("src",n),i.$showImage.removeClass("hidden"),i.options.multiple?a.hasClass("list-wiloke-image-media")?a.append(l):0===o?("url"===i.options.return?a.attr("data-url",e.url):a.attr("data-id",e.id),t("img",a).attr("src",n)):a.after(l):i.$showImage.empty().append(l)}),i.$input.trigger("change")):e.each(function(t,e){t=t.toJSON(),i.$input.val(t.url)})})},setMedia:function(){this.media=wp.media({title:o.title,button:{text:o.button},multiple:o.multiple})},setValueToInput:function(){var i=this;i.options.isPreview&&i.$input.change(function(){var e=[];i.$showImage.children(".wiloke-image").each(function(){t(this).data(i.options.return)&&e.push(t(this).data(i.options.return))}),e=e.join(","),i.$input.val(e)})}}.init()},t.fn.wilokePostFormatAudioPopup=function(i){var e=t(this);return{$el:e,options:t.extend({title:"My Audio",button:"Select",afterInit:function(t){}},e.data(),i),audio:null,$button:t(".wiloke-button",e),$input:t(".wiloke-audio-value",e),init:function(){this.createAudio(),this.events(),this.options.afterInit(this)},createAudio:function(){var t=this;t.audio=wp.media({title:t.options.title,button:{text:t.options.button},library:{type:"audio"},multiple:!1})},events:function(){var t=this;t.$button.click(function(){t.audio.open()}),t.audio.on("select",function(){t.audio.state().get("selection").each(function(i,e){t.$input.val(i.toJSON().url).trigger("change")})})}}.init()},t.fn.wilokeCheckValidationVideo=function(i){var e=t(this);return{$el:e,options:t.extend({},e.data(),i),$notice:null,$showImage:null,init:function(){this.createHTML(),this.events()},createHTML:function(){var t=this;t.$el.next(".wiloke-show-notice").length||t.$el.after('<ul class="wiloke-show-notice"><li class="wiloke-notice-button wiloke-url-pass"><i class="fa fa-check"></i></li><li class="wiloke-notice-button wiloke-url-not-pass"><i class="fa fa-close"></i></li></ul>'),t.$notice=t.$el.next(".wiloke-show-notice"),t.$notice.next(".wiloke-show-image").length||t.$notice.after('<div class="wiloke-show-image"><img src="" alt=""/></div>'),t.$imageShow=t.$notice.next(".wiloke-show-image")},events:function(){var i=this;i.$el.change(function(){var e=t(this).val(),o="",a="";if(-1!==e.search("youtube")?(e=e.match('(?:youtube(?:-nocookie)?.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu.be/)([^"&?/ ]{11})'))&&e[1]&&(o=e[1],a="youtube"):-1!==e.search("vimeo")?(e=e.match("(https?://)?(www.)?(player.)?vimeo.com/([a-z]*/)*([0-9]{6,11})[?]?.*"))&&e[5]&&(o=e[5],a="vimeo"):a="",t(".wiloke-notice-button",i.$notice).removeClass("active"),i.$imageShow.removeClass("wiloke-ajax-loading").hide(),""!==a){t(".wiloke-url-pass",i.$notice).addClass("active");var n="";"youtube"===a?(n="http://img.youtube.com/vi/"+o+"/0.jpg",t("img",i.$imageShow).attr("src",n),i.$imageShow.show()):"vimeo"===a&&(i.$imageShow.addClass("wiloke-ajax-loading"),t.ajax({type:"GET",url:"http://vimeo.com/api/v2/video/"+o+".json",jsonp:"callback",dataType:"jsonp",success:function(e){if(i.$imageShow.hasClass("wiloke-ajax-loading")){var o=e[0].thumbnail_large;i.$imageShow.removeClass("wiloke-ajax-loading"),t("img",i.$imageShow).attr("src",o)}i.$imageShow.show()}}))}else _.isEmpty(t(this).val())&&t(".wiloke-url-not-pass",i.$notice).addClass("active")})}}.init()},t.fn.wilokePostFormat=function(i){var e=t.extend({init:function(){},active:function(){}},i),o=t(this);return{$el:o,$controls:t("#wiloke-controls-post-format",o),$handles:t("#wiloke-handle-post-format",o),media:null,options:e,init:function(){var i=this;i.$el.show(200),i.setMedia(),i.events(),t("#formatdiv").hide(),t("li.active",i.$controls).trigger("click")},events:function(){var i=this;t("li",i.$controls).click(function(e){e.preventDefault();var o=t("a",this).attr("href"),a=t(o),n=t(this).data("format");a.length&&a.trigger("click"),t("li",i.$controls).removeClass("active"),t(this).addClass("active"),i.$handles.children().hide();var l=t("#wiloke-post-format-"+n);l.show();var s="";switch(n){case"video":s=t("#wiloke-video-field-url",l);break;case"audio":s=t("#wiloke-audio-field-url",l);break;case"quote":s=t("#wiloke-quote-field-content",l)}if(s.length){s.focus();var u=s.val();s.val("").val(u)}});var e=t("#wiloke-post-format-gallery"),o=t(".wiloke-type-gallery",e);o.change(function(){var i=t(this).val();t(this).prev().val(i)}).trigger("change"),o.prev().change(function(){o.val(t(this).val())});var a=t("#wiloke-video-field-url");a.wilokeCheckValidationVideo(),""!==a.val()&&a.trigger("change")},setMedia:function(){var i=this;t(".wiloke-button-media",i.$handles).each(function(){t(this).wilokePostFormatMediaPopup()}),t(".wiloke-button-audio",i.$handles).each(function(){t(this).wilokePostFormatAudioPopup({afterInit:function(e){e.$input.change(function(){t("#wiloke-audio-field-url",i.$handles).val(t(this).val()).trigger("change")})}})})}}.init()},t(document).ready(function(){t("#wiloke-post-format-wrapper").wilokePostFormat({})})}(jQuery)}();
